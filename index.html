<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TrendDS | Global Asset Ecosystem</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        /* --- Dƒ∞ZAYN Sƒ∞STEMƒ∞ --- */
        :root {
            --primary: #0d47a1; --secondary: #1565c0; --success: #00c853; --danger: #d32f2f;
            --bg: #f3f4f6; --card-bg: #ffffff; --text: #1e293b; --gold: #FFD700;
            --glass: rgba(255, 255, 255, 0.7); --glass-border: rgba(255, 255, 255, 0.2);
        }
        [data-theme="dark"] { --bg: #0f172a; --card-bg: #1e293b; --text: #f8fafc; --glass: rgba(30, 41, 59, 0.7); }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: var(--text); padding-bottom: 100px; overflow-x: hidden; transition: 0.3s; }

        /* --- UI ELEMENTL∆èRƒ∞ --- */
        .glass-panel { background: var(--glass); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid var(--glass-border); border-radius: 16px; margin-bottom: 20px; }
        .skeleton { background: linear-gradient(90deg, #eee 25%, #f5f5f5 50%, #eee 75%); background-size: 200% 100%; animation: loading 1.5s infinite; border-radius: 4px; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        
        #cinematicLoader { position: fixed; inset: 0; background: #000; z-index: 99999; display: flex; align-items: center; justify-content: center; flex-direction: column; animation: fadeOutLoader 1s ease 2.5s forwards; }
        .brand-anim { font-size: 40px; font-weight: 900; color: white; letter-spacing: 5px; animation: textExpand 2s ease-out; }
        @keyframes textExpand { 0% { letter-spacing: 20px; opacity: 0; } 100% { letter-spacing: 5px; opacity: 1; } }
        @keyframes fadeOutLoader { to { opacity: 0; visibility: hidden; } }

        #scrollProgress { position: fixed; top: 0; left: 0; height: 3px; background: var(--gold); z-index: 10000; width: 0%; transition: 0.1s; }

        #particles { position: absolute; inset: 0; z-index: 0; opacity: 0.3; pointer-events: none; }
        .ticker-wrap { position: fixed; top: 0; left: 0; width: 100%; overflow: hidden; height: 30px; background-color: #000; z-index: 9000; display: flex; align-items: center; border-bottom: 1px solid #333; }
        .ticker { display: inline-block; white-space: nowrap; padding-left: 100%; animation: ticker 40s linear infinite; }
        .ticker-item { display: inline-block; padding: 0 15px; font-size: 11px; color: #ccc; font-weight: 600; }
        .up { color: var(--success); } .down { color: var(--danger); }
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }
        
        .hero { background: linear-gradient(135deg, #0d47a1, #000000); color: white; padding: 80px 20px 70px 20px; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.4); position: relative; overflow: hidden; }
        
        .globe-container { width: 100px; height: 100px; margin: 0 auto 10px; position: relative; perspective: 1000px; }
        .globe { width: 100%; height: 100%; border-radius: 50%; background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Blue_Marble_2002.png/1024px-Blue_Marble_2002.png'); background-size: 200px; animation: spinGlobe 10s linear infinite; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        @keyframes spinGlobe { from { background-position: 0 0; } to { background-position: 200px 0; } }

        .chart-container { margin: -40px 20px 20px 20px; background: var(--card-bg); border-radius: 16px; padding: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); position: relative; z-index: 10; }
        canvas { width: 100%; height: 100px; }
        
        .market-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 0 20px 20px 20px; position: relative; z-index: 20; min-height: 300px; }
        @media (max-width: 350px) { .market-grid { grid-template-columns: 1fr; } }

        .item-card { background: var(--card-bg); border-radius: 16px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: 0.2s; position: relative; display: flex; flex-direction: column; }
        .item-img { width: 100%; height: 100px; object-fit: cover; }
        .item-body { padding: 12px; flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        
        .social-toast { position: fixed; bottom: 80px; left: 20px; background: rgba(0,0,0,0.8); color: white; padding: 10px 15px; border-radius: 50px; font-size: 11px; display: flex; align-items: center; gap: 10px; z-index: 8000; opacity: 0; transform: translateY(20px); transition: 0.5s; pointer-events: none; }
        .social-toast.show { opacity: 1; transform: translateY(0); }
        .st-img { width: 25px; height: 25px; border-radius: 50%; background: var(--success); }
        
        .ai-widget { position: fixed; bottom: 100px; right: 20px; width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 5px 20px rgba(13, 71, 161, 0.5); cursor: pointer; z-index: 6000; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        
        .btn-main { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 14px; touch-action: manipulation; position: relative; z-index: 30; }
        .btn-main:active { transform: scale(0.96); opacity: 0.9; }
        .btn-sm { padding: 8px 12px; font-size: 12px; width: auto; }
        
        .inp-field { width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 12px; margin-bottom: 10px; font-size: 16px; } 
        
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 25000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal-card { background: var(--card-bg); width: 100%; max-width: 350px; padding: 25px; border-radius: 20px; text-align: center; box-shadow: 0 0 50px rgba(0,0,0,0.5); animation: zoomIn 0.3s; }
        @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        /* STATƒ∞STƒ∞KA KARTLARI */
        .wallet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 20px; }
        .stat-card { background: var(--card-bg); padding: 15px; border-radius: 12px; border: 1px solid #eee; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .stat-card h4 { font-size: 10px; color: #888; text-transform: uppercase; margin-bottom: 5px; }
        .stat-card div { font-size: 16px; font-weight: 800; color: var(--text); }

        .visa-card { background: linear-gradient(135deg, #1a1a1a, #333); color: white; border-radius: 15px; padding: 20px; margin: 0 20px 20px 20px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 1px solid #444; overflow: hidden; transition: 0.5s; height: 180px; display: flex; flex-direction: column; justify-content: space-between; }
        .visa-chip { width: 40px; height: 30px; background: linear-gradient(135deg, #FFD700, #B8860B); border-radius: 5px; }
        .card-balance { font-size: 28px; font-weight: 800; margin-top: 10px; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        
        /* YENƒ∞: PUL √á∆èK BUTONU KART √úZ∆èRƒ∞ND∆è */
        .card-withdraw-btn {
            position: absolute;
            bottom: 15px;
            right: 20px;
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 6px 15px;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(211, 47, 47, 0.3);
            transition: all 0.3s;
            z-index: 10;
        }
        .card-withdraw-btn:active {
            transform: scale(0.95);
            opacity: 0.9;
        }
        .card-withdraw-btn:hover {
            background: linear-gradient(135deg, #b71c1c, #8b0000);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.4);
        }

        /* QAZANC KARTI */
        .profit-card { background: linear-gradient(135deg, #00c853, #009624); color: white; border-radius: 15px; padding: 20px; margin: 0 20px; position: relative; box-shadow: 0 10px 30px rgba(0,200,83,0.3); overflow: hidden; cursor: pointer; }
        .profit-balance { font-size: 32px; font-weight: 800; margin: 10px 0; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .profit-anim { position: absolute; right: -20px; top: -20px; font-size: 100px; opacity: 0.1; transform: rotate(20deg); color: white; }

        .cookie-banner { position: fixed; bottom: 0; left: 0; width: 100%; background: #222; color: white; padding: 15px; z-index: 20000; display: flex; justify-content: space-between; align-items: center; font-size: 11px; transform: translateY(100%); transition: 0.5s; padding-bottom: 30px; }
        .cookie-banner.show { transform: translateY(0); }

        .hot-tag { position: absolute; top: 10px; right: 10px; background: red; color: white; font-size: 9px; padding: 3px 8px; border-radius: 10px; animation: pulse 1s infinite; z-index: 2; }
        
        #authScreen { position: fixed; inset: 0; z-index: 10000; background: linear-gradient(135deg, #000, #0d47a1); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .auth-card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); padding: 40px 30px; border-radius: 20px; width: 100%; max-width: 380px; text-align: center; color: white; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 2; }
        
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: var(--card-bg); height: 80px; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #eee; z-index: 5000; padding-bottom: 20px; }
        .nav-btn { flex: 1; text-align: center; color: #888; background: none; border: none; font-size: 10px; padding: 5px; }
        .nav-btn.active { color: var(--primary); }
        .nav-btn i { font-size: 24px; display: block; margin-bottom: 5px; }
        
        .chat-box { position: fixed; bottom: 90px; right: 20px; width: 300px; background: white; border-radius: 15px; box-shadow: 0 5px 30px rgba(0,0,0,0.2); z-index: 6000; display: none; padding: 15px; }
        .chat-header { font-weight: bold; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; }

        .confetti { position: fixed; width: 10px; height: 10px; background-color: #f00; animation: fall linear forwards; z-index: 24000; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }

        .history-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; font-size: 12px; }
        .history-type { font-weight: bold; }
        .history-time { font-size: 10px; color: #888; }

        .blink { animation: blink 1.5s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        
        /* DEBUG PANEL */
        .debug-panel { background: rgba(0,0,0,0.05); padding: 8px; border-radius: 8px; font-size: 10px; color: #666; margin: 5px 20px; border: 1px solid #eee; }
        .debug-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
        
        /* YENƒ∞: MOTƒ∞VASƒ∞YA BANNERƒ∞ */
        .motivation-banner {
            background: linear-gradient(135deg, #0d47a1, #00c853);
            color: white;
            padding: 25px 20px;
            margin: 20px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .motivation-banner h3 {
            font-size: 20px;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .motivation-banner p {
            font-size: 13px;
            opacity: 0.9;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .motivation-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            font-size: 12px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 18px;
            font-weight: 800;
            color: var(--gold);
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .stat-label {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 3px;
        }
        .success-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: bold;
        }
        
        /* YENƒ∞: INVESTMENT LOCK MESSAGE */
        .investment-lock-message {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 20px;
            font-size: 12px;
            color: #856404;
        }
        .investment-lock-message.dark {
            background: rgba(255, 193, 7, 0.15);
            border-color: #ffc107;
            color: #ffc107;
        }
        
        /* YENƒ∞: SERMAYE √á∆èK BUTON R∆èNGL∆èRƒ∞ */
        .btn-withdraw-locked {
            background: #6c757d !important;
            color: white !important;
            cursor: not-allowed !important;
            opacity: 0.7 !important;
        }
        .btn-withdraw-active {
            background: #28a745 !important;
            color: white !important;
            animation: pulse 1.5s infinite !important;
        }
        
        /* YENƒ∞: BALANS Tƒ∞PL∆èRƒ∞ G√ñST∆èRƒ∞Cƒ∞Sƒ∞ */
        .balance-types {
            display: flex;
            justify-content: space-between;
            margin: 10px 20px;
            font-size: 11px;
            color: #666;
        }
        .balance-type {
            text-align: center;
            flex: 1;
            padding: 5px;
            border-radius: 8px;
            background: rgba(0,0,0,0.03);
            margin: 0 5px;
        }
        .balance-type.active {
            background: rgba(13, 71, 161, 0.1);
            border: 1px solid rgba(13, 71, 161, 0.3);
        }
        .balance-type .value {
            font-weight: bold;
            color: var(--text);
            font-size: 12px;
            margin-top: 3px;
        }

        /* YENƒ∞: G√úND∆èLƒ∞K G∆èLƒ∞R √áIXARI≈û BUTONU */
        .daily-profit-btn {
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .daily-profit-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        .daily-profit-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }
    </style>
</head>
<body>

    <div id="cinematicLoader">
        <div class="brand-anim">TRENDDS</div>
        <div style="font-size:12px; color:gold; margin-top:10px;">ULTIMATE EDITION</div>
    </div>

    <div id="scrollProgress"></div>
    <audio id="sndDing" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3"></audio>

    <div class="ticker-wrap">
        <div class="ticker">
            <span class="ticker-item">BTC <span class="up">$98,420 ‚ñ≤</span></span>
            <span class="ticker-item">ETH <span class="up">$3,210 ‚ñ≤</span></span>
            <span class="ticker-item"><i class="fas fa-fire" style="color:orange"></i> HOT: Real Estate +15%</span>
            <span class="ticker-item">USER_88 invested <span class="up">$5,000</span></span>
        </div>
    </div>

    <div id="authScreen">
        <canvas id="particles"></canvas>
        <div class="auth-card animate__animated animate__fadeInUp">
            <i class="fas fa-fingerprint" style="font-size:50px; margin-bottom:20px; color:var(--gold); opacity:0.8; animation: pulse 2s infinite;"></i>
            <h2 style="margin-bottom:5px;">TrendDS Global</h2>
            <p style="font-size:12px; opacity:0.7; margin-bottom:30px;">Secure Biometric Access</p>
            <input type="text" id="rName" class="inp-field" placeholder="Full Name" style="background:rgba(255,255,255,0.9); color:#333;">
            <input type="email" id="rEmail" class="inp-field" placeholder="Email" style="background:rgba(255,255,255,0.9); color:#333;">
            <button class="btn-main" onclick="startBiometricLogin()"><i class="fas fa-face-viewfinder"></i> FACE ID LOGIN</button>
        </div>
    </div>

    <div id="appScreen" style="display:none; padding-top:30px;">
        
        <div id="socialToast" class="social-toast">
            <div class="st-img"></div>
            <div id="stText">User invested $500</div>
        </div>

        <div class="ai-widget" onclick="toggleChat()"><i class="fas fa-comments"></i></div>
        <div id="chatBox" class="chat-box">
            <div class="chat-header"><span>AI Support</span> <span onclick="toggleChat()" style="cursor:pointer">x</span></div>
            <div style="height:150px; overflow-y:auto; font-size:12px; color:#666;" id="chatContent"><div>Bot: Hello! How can I help?</div></div>
            <input type="text" placeholder="Type..." style="width:100%; border:1px solid #ddd; padding:5px; margin-top:10px;" onkeypress="if(event.key==='Enter') sendChat(this)">
        </div>

        <div id="calcModal" class="modal-overlay">
            <div class="modal-card">
                <h3><i class="fas fa-calculator"></i> G…ôlir Hesablayƒ±cƒ±</h3>
                <div style="margin-top:15px; text-align:left;">
                    <label style="font-size:12px; color:#666;">ƒ∞nvestisiya M…ôbl…ôƒü ($):</label>
                    <input type="number" id="calcInput" class="inp-field" placeholder="M…ôs: 1000" oninput="calcProfit()">
                    <div style="background:#f8f9fa; padding:10px; border-radius:8px; margin-top:10px;">
                        <p style="font-size:13px; display:flex; justify-content:space-between;">G√ºnl√ºk (1.5%): <b id="calcDaily" style="color:green">$0.00</b></p>
                        <p style="font-size:13px; display:flex; justify-content:space-between;">Aylƒ±q (30 g√ºn): <b id="calcMonthly" style="color:green">$0.00</b></p>
                    </div>
                </div>
                <button class="btn-main" style="margin-top:10px; background:#444;" onclick="closeModal('calcModal')">Baƒüla</button>
            </div>
        </div>

        <div id="successModal" class="modal-overlay">
            <div class="modal-card">
                <div class="modal-icon" style="color:var(--success); font-size:50px;"><i class="fas fa-check-circle"></i></div>
                <div class="modal-title" style="font-weight:800; font-size:20px; margin-top:10px;">T…ôbrik edirik!</div>
                <div class="modal-text" id="successMsg" style="margin:15px 0;"></div>
                <button class="btn-main" style="background:var(--success)" onclick="closeModal('successModal')">∆èla!</button>
            </div>
        </div>

        <div id="view-home" style="display:block;">
            <!-- MOTƒ∞VASƒ∞YA BANNERƒ∞ -->
            <div class="motivation-banner animate__animated animate__fadeIn">
                <span class="success-badge">üî• TRENDING</span>
                <h3>üöÄ Mƒ∞LYON√áU OLMAQ √ú√á√úN ƒ∞LK ADDIM!</h3>
                <p>
                    Sizin buradakƒ± investisiyalarƒ±nƒ±z real d√ºnya bazarƒ±nda i≈ül…ôyir v…ô global qazanc g…ôtirir.
                    H…ôr investisiya real aktivl…ôr…ô √ßevrilir v…ô beyn…ôlxalq platformalarda g…ôlir generasiya edir.
                </p>
                <p style="font-size:11px; font-style:italic; opacity:0.8;">
                    üíé 500,000+ istifad…ô√ßi artƒ±q qazanc …ôld…ô edir<br>
                    üåç 50+ √∂lk…ôd…ô aktiv investisiya<br>
                    ‚ö° Real vaxt rejimind…ô g…ôlir
                </p>
                <div class="motivation-stats">
                    <div class="stat-item">
                        <div class="stat-value">$2.1B+</div>
                        <div class="stat-label">√úmumi H…ôcm</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">98.7%</div>
                        <div class="stat-label">M√ºsb…ôt G…ôlir</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">45%</div>
                        <div class="stat-label">Orta Artƒ±m</div>
                    </div>
                </div>
            </div>

            <div class="hero">
                <div style="position:absolute; top:40px; right:20px; z-index:500; display:flex; gap:5px;">
                    <button class="nav-btn" style="color:white; border:1px solid rgba(255,255,255,0.3); padding:2px 8px; border-radius:10px;" onclick="toggleTheme()">DARK</button>
                </div>
                <div class="globe-container"><div class="globe"></div></div>
                <h1 id="heroTitle">TrendDS Global</h1>
                <p>AI-Powered Asset Management</p>
            </div>

            <!-- INVESTƒ∞Sƒ∞YA QEYD MESAJI -->
            <div id="investmentLockMessage" class="investment-lock-message" style="display:none;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                    <i class="fas fa-lock" style="color:#ffc107; font-size:16px;"></i>
                    <strong>M√úH√úM QEYD:</strong>
                </div>
                <div style="font-size:11px; line-height:1.4;">
                    üìå <strong>ƒ∞nvestisiya etdiyiniz m…ôbl…ôƒü √úMUMƒ∞ BALANSDAN √áIXILIR</strong><br>
                    ‚è≥ <strong>30 g√ºn …ôrzind…ô bu m…ôbl…ôƒüi √á∆èKƒ∞L∆è Bƒ∞LM∆èZSƒ∞Nƒ∞Z</strong><br>
                    ‚úÖ <strong>30 g√ºnd…ôn sonra "S…ôrmay…ôni Geri √á…ôk" d√ºym…ôsi aktiv olacaq</strong><br>
                    üí∞ <strong>S…ôrmay…ôni geri √ß…ôkdikd…ô, m…ôbl…ôƒü √úMUMƒ∞ BALANSA …ôlav…ô olunacaq</strong>
                </div>
            </div>

            <div class="chart-container">
                <div style="display:flex; justify-content:space-between; font-size:12px; margin-bottom:5px;">
                    <span>TDS INDEX</span><span style="color:green">+12.4%</span>
                </div>
                <canvas id="liveChart"></canvas>
            </div>

            <h4 style="padding:0 20px; margin-bottom:10px; display:flex; align-items:center; gap:8px;">
                <i class="fas fa-crown" style="color:gold;"></i>
                ƒ∞nvestisiya Paketl…ôri
            </h4>
            <div class="market-grid" id="marketGrid"></div>
            
            <!-- DEBUG PANEL -->
            <div class="debug-panel">
                <div class="debug-row">
                    <span>‚ö†Ô∏è Qeyd: G…ôlir YALNIZ investisiya sonrasƒ±</span>
                    <button onclick="toggleDebug()" style="background:none; border:none; color:#666; font-size:8px;">‚ñº</button>
                </div>
                <div id="debugDetails" style="display:none; margin-top:5px;">
                    <div class="debug-row">
                        <span>Total Invested:</span>
                        <span id="debugInv">$0</span>
                    </div>
                    <div class="debug-row">
                        <span>G…ôlir/saniy…ô:</span>
                        <span id="debugPerSec">$0</span>
                    </div>
                    <div class="debug-row">
                        <span>Son yenil…ôm…ô:</span>
                        <span id="debugTime">-</span>
                    </div>
                </div>
            </div>
            
            <!-- √úST√úNL√úKL∆èR Sƒ∞YAHISI -->
            <div style="padding:0 20px; margin-top:20px;">
                <h4 style="margin-bottom:10px; font-size:14px; color:var(--primary);">üéØ Nƒ∞Y∆è Bƒ∞Z?</h4>
                <div style="background:var(--card-bg); padding:15px; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.05);">
                    <div style="display:flex; align-items:start; gap:10px; margin-bottom:10px;">
                        <div style="background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px;">1</div>
                        <div>
                            <strong style="font-size:12px;">Real D√ºnya Aktivl…ôri</strong>
                            <p style="font-size:11px; color:#666; margin-top:3px;">Investisiyalarƒ±nƒ±z real estate, stocks, tech ≈üirk…ôtl…ôrin…ô √ßevrilir</p>
                        </div>
                    </div>
                    <div style="display:flex; align-items:start; gap:10px; margin-bottom:10px;">
                        <div style="background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px;">2</div>
                        <div>
                            <strong style="font-size:12px;">Global Qazanc</strong>
                            <p style="font-size:11px; color:#666; margin-top:3px;">D√ºnya bazarƒ±ndan g…ôlir …ôld…ô edin, lokal m…ôhdudiyy…ôtl…ôr yoxdur</p>
                        </div>
                    </div>
                    <div style="display:flex; align-items:start; gap:10px;">
                        <div style="background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px;">3</div>
                        <div>
                            <strong style="font-size:12px;">Tam ≈û…ôffaflƒ±q</strong>
                            <p style="font-size:11px; color:#666; margin-top:3px;">H…ôr investisiya harada i≈ül…ôdiyini g√∂r…ô bil…ôrsiniz</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="height:100px;"></div>
        </div>

        <div id="view-cabinet" style="display:none;">
            
            <div class="profile-header" style="border:none; padding-top:0; text-align:center;">
                <h3 id="dispName">User</h3>
                <div style="font-size:12px; color:#999; margin-bottom:15px;">Professional Account</div>
            </div>

            <!-- YENƒ∞: BALANS Tƒ∞PL∆èRƒ∞ G√ñST∆èRƒ∞Cƒ∞Sƒ∞ -->
            <div class="balance-types">
                <div class="balance-type active" id="balanceType1" onclick="switchBalanceType(1)">
                    <div>Disponibil</div>
                    <div class="value" id="dispAvailable">$0</div>
                </div>
                <div class="balance-type" id="balanceType2" onclick="switchBalanceType(2)">
                    <div>Aktiv S…ôrmay…ô</div>
                    <div class="value" id="dispInvestedAmount">$0</div>
                </div>
                <div class="balance-type" id="balanceType3" onclick="switchBalanceType(3)">
                    <div>G…ôlir</div>
                    <div class="value" id="dispProfitAmount">$0</div>
                </div>
            </div>

            <!-- INVESTƒ∞Sƒ∞YA QEYD MESAJI (CABINET) -->
            <div id="cabinetLockMessage" class="investment-lock-message" style="margin:0 20px 15px 20px;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                    <i class="fas fa-info-circle" style="color:var(--primary); font-size:16px;"></i>
                    <strong>MALƒ∞YY∆è QAYDALARI:</strong>
                </div>
                <div style="font-size:11px; line-height:1.4;">
                    üí∞ <strong>√úmumi Balans = Disponibil Balans + Aktiv S…ôrmay…ô + G…ôlir</strong><br>
                    üîí <strong>ƒ∞nvestisiya etdiyiniz m…ôbl…ôƒü 30 g√ºn m√ºdd…ôtind…ô √á∆èKƒ∞L∆è Bƒ∞LM∆èZ</strong><br>
                    ‚è∞ <strong>30 g√ºnd…ôn sonra "S…ôrmay…ôni Geri √á…ôk" d√ºym…ôsi aktiv olacaq</strong><br>
                    ‚ûï <strong>S…ôrmay…ô geri √ß…ôkildikd…ô, m…ôbl…ôƒü Disponibil Balansa …ôlav…ô olunacaq</strong>
                </div>
            </div>

            <div class="wallet-grid">
                <div class="stat-card">
                    <h4>√úmumi Balans</h4>
                    <div id="dashTotal">$0.00</div>
                </div>
                <div class="stat-card">
                    <h4>Aktiv S…ôrmay…ô</h4>
                    <div id="dashInvested" style="color:blue">$0.00</div>
                </div>
            </div>

            <h4 style="padding:0 20px; margin-bottom:5px; font-size:12px; color:#666;">CANLI G∆èLƒ∞R M∆èNB∆èYƒ∞</h4>
            <div class="profit-card" onclick="showProfitAnalysis()">
                <i class="fas fa-bolt profit-anim"></i>
                <div style="font-size:11px; opacity:0.8;">Saniy…ôlik Yƒ±ƒüƒ±lan Faiz</div>
                <div class="profit-balance" id="dispEarned">$0.000000</div>
                <div style="font-size:10px; margin-bottom:10px;">Status: <span id="profitStatus" class="blink">‚óè G√∂zl…ôyir</span></div>
                <button class="btn-main btn-sm" style="background:white; color:green; width:100%;" onclick="claimProfit()">
                    <i class="fas fa-download"></i> BALANSA K√ñ√á√úR
                </button>
            </div>

            <h4 style="padding:20px 20px 5px 20px; font-size:12px; color:#666;">∆èSAS C√úZDAN (Visa)</h4>
            <div class="visa-card" id="myVisa">
                <div style="position:absolute; top:20px; right:20px; font-weight:bold; font-style:italic; font-size:20px;">VISA</div>
                <!-- YENƒ∞: PUL √á∆èK BUTONU -->
                <button class="card-withdraw-btn" onclick="withdrawFullBalance()">
                    <i class="fas fa-wallet"></i> PULU √á∆èK
                </button>
                <div class="visa-chip"></div>
                <div style="font-size:10px; opacity:0.7; margin-top:10px;">Disponibil Balans</div>
                <div class="card-balance" id="dispBalance">$0.00</div>
                
                <div style="font-family:monospace; font-size:18px; letter-spacing:2px; margin-bottom:15px; text-shadow:0 2px 2px rgba(0,0,0,0.5);" id="cardNumDisplay">
                    4455 ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 9012
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <div style="text-transform:uppercase; font-size:12px; opacity:0.8;" id="cardNameDisplay">USER NAME</div>
                    <div style="font-size:12px;">EXP 12/28</div>
                </div>
            </div>

            <!-- YENƒ∞: G√úND∆èLƒ∞K G∆èLƒ∞R √áIXARI≈û KARTI -->
            <div style="padding:0 20px; margin-top:15px;">
                <div style="background:linear-gradient(135deg, #9c27b0, #673ab7); color:white; padding:15px; border-radius:12px; box-shadow:0 5px 20px rgba(156, 39, 176, 0.3);">
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                        <i class="fas fa-calendar-day" style="font-size:20px;"></i>
                        <div>
                            <div style="font-weight:bold; font-size:14px;">G√úND∆èLƒ∞K G∆èLƒ∞R √áIXARI≈ûI</div>
                            <div style="font-size:10px; opacity:0.9;">3 g√ºnd…ôn bir, minimum $20</div>
                        </div>
                    </div>
                    
                    <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:8px; margin-bottom:10px;">
                        <div style="display:flex; justify-content:space-between; font-size:11px; margin-bottom:5px;">
                            <span>G√ºnl√ºk g…ôlir:</span>
                            <span id="dailyProfitAmount" style="font-weight:bold;">$0.00</span>
                        </div>
                        <div style="display:flex; justify-content:space-between; font-size:11px;">
                            <span>Son √ßƒ±xarƒ±≈ü:</span>
                            <span id="lastDailyWithdraw" style="font-size:10px;">He√ß vaxt</span>
                        </div>
                    </div>
                    
                    <button class="daily-profit-btn" onclick="withdrawDailyProfit()" id="dailyProfitBtn">
                        <i class="fas fa-wallet"></i> G√úND∆èLƒ∞K G∆èLƒ∞Rƒ∞ √á∆èK
                    </button>
                    
                    <div style="font-size:9px; opacity:0.7; margin-top:8px; text-align:center; padding:5px; background:rgba(0,0,0,0.2); border-radius:5px;">
                        ‚ö†Ô∏è WhatsApp-a y√∂nl…ôndiril…ôn m…ôlumatƒ± d…ôyi≈üm…ôk QADAƒûANDIR
                    </div>
                </div>
            </div>

            <!-- Visa kartƒ±ndan SONRA bu hiss…ôni …ôlav…ô et -->
            <div style="padding:0 20px; margin-top:10px;">
                <div style="background:rgba(255, 193, 7, 0.1); border:1px solid #ffc107; border-radius:10px; padding:12px; font-size:11px; color:#856404;">
                    <div style="display:flex; align-items:center; gap:8px; margin-bottom:5px;">
                        <i class="fas fa-exclamation-triangle" style="color:#ffc107;"></i>
                        <strong>M√úH√úM QAYDALAR:</strong>
                    </div>
                    <div style="font-size:10px; line-height:1.4;">
                        1. WhatsApp-a y√∂nl…ôndiril…ôn m…ôlumatƒ± <strong style="color:#d32f2f;">D∆èYƒ∞≈ûM∆èK QADAƒûANDIR</strong><br>
                        2. Avtomatik g√∂nd…ôril…ôn formada m…ôlumatlar d√ºzg√ºn qeyd olunub<br>
                        3. M…ôlumatƒ± d…ôyi≈üdikd…ô, balansƒ±nƒ±z <strong>SIFIRLANACAQ</strong><br>
                        4. Yalnƒ±z √∂z hesabƒ±nƒ±z √º√ß√ºn √ßƒ±xarƒ±≈ü edin
                    </div>
                </div>
            </div>

            <div style="padding:0 20px; margin-top:20px;">
                 <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:15px;">
                     <button class="btn-main" onclick="requestDeposit()" style="background:#25D366;"><i class="fab fa-whatsapp"></i> Artƒ±r</button>
                     <button class="btn-main" onclick="handleWithdraw()" style="background:var(--text);"><i class="fas fa-wallet"></i> √áƒ±xar</button>
                     <button class="btn-main" onclick="toggleCardEdit()" style="background:#ff9800; color:white;"><i class="fas fa-edit"></i> Kart</button>
                 </div>

                 <div id="cardEditForm" class="glass-panel" style="padding:15px; display:none;">
                    <input type="text" id="newCardName" class="inp-field" placeholder="Ad Soyad">
                    <input type="text" id="newCardNum" class="inp-field" placeholder="Kart N√∂mr…ôsi">
                    <button class="btn-main btn-sm" onclick="saveCardDetails()">Yadda Saxla</button>
                 </div>

                 <div style="margin-top:20px;">
                    <input type="text" id="pCode" class="inp-field" placeholder="Promo Kod">
                    <button class="btn-main" onclick="applyPromo()">Aktivl…ô≈üdir</button>
                 </div>

                 <h4 style="margin-top:20px; display:flex; align-items:center; justify-content:space-between;">
                    <span>Aktiv Portfelim</span>
                    <span style="font-size:10px; color:#666;" id="portfolioCount">0 investisiya</span>
                 </h4>
                 <div id="portfolioList">
                     <div class="skeleton" style="height:50px; margin-bottom:10px;"></div>
                 </div>

                 <h4 style="margin-top:20px;">∆èm…ôliyyat Tarix√ß…ôsi</h4>
                 <div id="historyList" class="glass-panel" style="padding:10px; max-height:200px; overflow-y:auto;">
                     <div style="text-align:center; color:#999; font-size:12px;">H…ôl…ô ki …ôm…ôliyyat yoxdur</div>
                 </div>
                 
                 <button class="btn-main" onclick="logout()" style="background:#f44336; margin-top:20px;">√áƒ±xƒ±≈ü</button>
            </div>
            <div style="height:100px;"></div>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn active" onclick="switchView('home', this)"><i class="fas fa-globe"></i> Hub</button>
            <button class="nav-btn" onclick="switchView('cabinet', this)"><i class="fas fa-wallet"></i> Wallet</button>
            <button class="nav-btn" onclick="openModal('calcModal')"><i class="fas fa-calculator"></i> Calc</button>
            <button class="nav-btn" onclick="contactSupport()"><i class="fas fa-headset"></i> Help</button>
        </div>
        
    </div>

    <script>
        // VERSION KEY
        const STORAGE_KEY = 'trendds_final_working_v5';

        // --- PRELOADER & AUTO LOGIN ---
        window.onload = () => { 
            setTimeout(() => { 
                document.getElementById('cinematicLoader').style.opacity = '0';
                setTimeout(() => document.getElementById('cinematicLoader').style.display = 'none', 500);
            }, 2000);
            
            renderGrid();

            const savedData = localStorage.getItem(STORAGE_KEY);
            if(savedData) {
                try {
                    user = JSON.parse(savedData);
                    if(user && user.email) {
                        console.log("User found:", user.email);
                        initApp(); 
                    }
                } catch(e) {
                    console.error("Error parsing saved data:", e);
                }
            }
        };

        window.onscroll = () => {
            let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            let scrolled = (winScroll / height) * 100;
            document.getElementById("scrollProgress").style.width = scrolled + "%";
        };

        // --- PARTICLES ---
        const canvas = document.getElementById("particles"); 
        const ctx = canvas.getContext("2d"); 
        canvas.width = window.innerWidth; 
        canvas.height = window.innerHeight;
        
        let particlesArray = []; 
        class Particle { 
            constructor(){ 
                this.x=Math.random()*canvas.width; 
                this.y=Math.random()*canvas.height; 
                this.size=Math.random()*2; 
                this.speedX=Math.random()*1-0.5; 
                this.speedY=Math.random()*1-0.5; 
            } 
            update(){ 
                this.x+=this.speedX; 
                this.y+=this.speedY; 
                if(this.size>0.2) this.size-=0.1; 
            } 
            draw(){ 
                ctx.fillStyle='rgba(255,255,255,0.5)'; 
                ctx.beginPath(); 
                ctx.arc(this.x,this.y,this.size,0,Math.PI*2); 
                ctx.fill(); 
            } 
        }
        
        setInterval(()=>{ particlesArray.push(new Particle()); }, 100); 
        function animate(){ 
            ctx.clearRect(0,0,canvas.width,canvas.height); 
            for(let i=0; i<particlesArray.length; i++){ 
                particlesArray[i].update(); 
                particlesArray[i].draw(); 
                if(particlesArray[i].size<=0.3){
                    particlesArray.splice(i,1);
                    i--;
                }
            } 
            requestAnimationFrame(animate); 
        } 
        animate();

        // --- CHART ---
        const chartC = document.getElementById('liveChart'); 
        const cCtx = chartC.getContext('2d'); 
        let cData = [50, 52, 51, 53, 55, 54, 58, 60, 59, 62, 65, 63, 67, 70];
        
        function drawChart() { 
            chartC.width = chartC.offsetWidth; 
            chartC.height = chartC.offsetHeight; 
            cCtx.clearRect(0,0,chartC.width,chartC.height); 
            cCtx.beginPath(); 
            cCtx.moveTo(0, chartC.height); 
            let step = chartC.width / (cData.length - 1); 
            for(let i=0; i<cData.length; i++){ 
                let h = 100 - cData[i]; 
                cCtx.lineTo(i*step, h); 
            } 
            cCtx.strokeStyle = '#00c853'; 
            cCtx.lineWidth = 2; 
            cCtx.stroke(); 
            if(Math.random()>0.5) {
                cData.push(cData[cData.length-1] + Math.random()*2); 
            } else {
                cData.push(cData[cData.length-1] - Math.random()*2); 
            }
            if(cData.length > 20) cData.shift(); 
        }
        setInterval(drawChart, 1000);

        // --- CORE LOGIC ---
        const API = "https://script.google.com/macros/s/AKfycbw6gXUMslAGxWx21nUKzDhND279Yjv-VckDo8Y_fMEg-m7J35ocE8weS-mVeXLDzdR3/exec";
        const PHONE = "994507516137";
        
        let user = { 
            name: "", 
            email: "", 
            // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANS (ƒ∞stifad…ô oluna bil…ôn pul)
            availableBalance: 0,
            // ‚úÖ YIƒûILMI≈û G∆èLƒ∞R (investisiyalardan qazanƒ±lan)
            earned: 0,
            // ‚úÖ AKTƒ∞V SERMAY∆èL∆èR (30 g√ºnl√ºk investisiya)
            investments: [], 
            lastWithdraw: 0, 
            // YENƒ∞: G√ºnd…ôlik g…ôlir √ßƒ±xarƒ±≈üƒ± √º√ß√ºn
            lastDailyProfitWithdraw: 0,
            dailyProfitWithdrawCount: 0,
            history: [],
            cardName: "USER NAME", 
            cardNum: "4455 ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 9012", 
            lastSync: Date.now(),
            totalInvested: 0
        };
        
        const markets = [
            {n:"Real Estate", p:500, img:"https://images.unsplash.com/photo-1560518883-ce09059eeffa", hot:true}, 
            {n:"Stocks", p:400, img:"https://images.unsplash.com/photo-1611974765270-ca1258634369", hot:false},
            {n:"Tech AI", p:300, img:"https://images.unsplash.com/photo-1518770660439-4636190af475", hot:true},
            {n:"Agro", p:200, img:"https://images.unsplash.com/photo-1625246333195-78d9c38ad449", hot:false},
            {n:"Retail", p:100, img:"https://images.unsplash.com/photo-1542838132-92c53300491e", hot:false},
            {n:"Goods", p:50, img:"https://images.unsplash.com/photo-1583947215259-38e31be8751f", hot:false}
        ];

        // --- UTILITY FUNCTIONS ---
        function vibe() { 
            if(navigator.vibrate) navigator.vibrate(50); 
        }
        
        function playSound() { 
            const audio = document.getElementById('sndDing');
            audio.currentTime = 0;
            audio.play().catch(e => console.log("Audio error:", e)); 
        }
        
        function toggleChat() { 
            let b = document.getElementById('chatBox'); 
            b.style.display = b.style.display === 'block' ? 'none' : 'block'; 
        }
        
        function sendChat(e) { 
            if(e.value.trim() === '') return;
            
            const chatContent = document.getElementById('chatContent');
            chatContent.innerHTML += `<div style="text-align:right;margin-top:5px;color:blue;">You: ${e.value}</div>`;
            chatContent.scrollTop = chatContent.scrollHeight;
            e.value = ''; 
            
            setTimeout(() => { 
                chatContent.innerHTML += `<div style="margin-top:5px;color:green;">AI: Investisiya √º√ß√ºn paketl…ôri yoxlayƒ±n</div>`;
                chatContent.scrollTop = chatContent.scrollHeight;
                playSound(); 
            }, 1000); 
        }
        
        function closeModal(id) { 
            document.getElementById(id).style.display = 'none'; 
        }
        
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
        }
        
        function toggleDebug() {
            const debugDetails = document.getElementById('debugDetails');
            debugDetails.style.display = debugDetails.style.display === 'block' ? 'none' : 'block';
        }

        // --- YENƒ∞: BALANS Tƒ∞Pƒ∞Nƒ∞ D∆èYƒ∞≈ûDƒ∞R ---
        let currentBalanceType = 1; // 1: Disponibil, 2: Aktiv S…ôrmay…ô, 3: G…ôlir
        
        function switchBalanceType(type) {
            currentBalanceType = type;
            
            // Butonlarƒ± yenil…ô
            document.querySelectorAll('.balance-type').forEach((btn, index) => {
                if (index + 1 === type) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Balans d…ôy…ôrl…ôrini g√∂st…ôr
            updateBalanceDisplay();
        }
        
        function updateBalanceDisplay() {
            const totalInvested = user.investments.reduce((a,b) => a + b.amount, 0);
            const totalAssets = user.availableBalance + user.earned + totalInvested;
            
            // Balans tipl…ôri √º√ß√ºn d…ôy…ôrl…ôr
            document.getElementById('dispAvailable').innerText = "$" + user.availableBalance.toFixed(2);
            document.getElementById('dispInvestedAmount').innerText = "$" + totalInvested.toFixed(2);
            document.getElementById('dispProfitAmount').innerText = "$" + user.earned.toFixed(2);
            
            // √úmumi balans g√∂st…ôricisi
            document.getElementById('dashTotal').innerText = "$" + totalAssets.toFixed(2);
            document.getElementById('dashInvested').innerText = "$" + totalInvested.toFixed(2);
            
            // Kart √ºz…ôrind…ôki balans (H∆èR ZAMAN Dƒ∞SPONƒ∞Bƒ∞L BALANS)
            document.getElementById('dispBalance').innerText = "$" + user.availableBalance.toFixed(2);
        }

        // --- YENƒ∞: T∆èMA MOTƒ∞VASƒ∞YA MESAJINI G√ñST∆èR ---
        function showInvestmentLockMessage() {
            const lockMessage = document.getElementById('investmentLockMessage');
            const cabinetLockMessage = document.getElementById('cabinetLockMessage');
            
            if (user.investments.length > 0) {
                lockMessage.style.display = 'block';
                if (document.body.getAttribute('data-theme') === 'dark') {
                    lockMessage.classList.add('dark');
                }
            } else {
                lockMessage.style.display = 'none';
            }
            
            cabinetLockMessage.style.display = 'block';
            if (document.body.getAttribute('data-theme') === 'dark') {
                cabinetLockMessage.classList.add('dark');
            }
        }

        // --- YENƒ∞: G√úND∆èLƒ∞K G∆èLƒ∞R √áIXARI≈ûI ---
        function calculateDailyProfit() {
            const totalInvested = user.investments.reduce((a,b) => a + b.amount, 0);
            const dailyProfit = totalInvested * 0.015; // G√ºnl√ºk 1.5%
            return dailyProfit;
        }

        function updateDailyProfitUI() {
            const dailyProfit = calculateDailyProfit();
            const dailyProfitBtn = document.getElementById('dailyProfitBtn');
            const dailyProfitAmount = document.getElementById('dailyProfitAmount');
            const lastDailyWithdraw = document.getElementById('lastDailyWithdraw');
            
            // G√ºnl√ºk g…ôliri g√∂st…ôr
            dailyProfitAmount.innerText = "$" + dailyProfit.toFixed(2);
            
            // Son √ßƒ±xarƒ±≈ü tarixini g√∂st…ôr
            if (user.lastDailyProfitWithdraw > 0) {
                const lastDate = new Date(user.lastDailyProfitWithdraw);
                lastDailyWithdraw.innerText = lastDate.toLocaleDateString('az-AZ') + " " + lastDate.toLocaleTimeString('az-AZ', {hour: '2-digit', minute:'2-digit'});
            } else {
                lastDailyWithdraw.innerText = "He√ß vaxt";
            }
            
            // Buton statusunu t…ônziml…ô
            if (dailyProfit < 20) {
                dailyProfitBtn.disabled = true;
                dailyProfitBtn.innerHTML = `<i class="fas fa-lock"></i> MIN. $20 G∆èR∆èKLƒ∞`;
                dailyProfitBtn.title = "Minimum $20 g√ºnl√ºk g…ôlir t…ôl…ôb olunur";
            } else if (user.lastDailyProfitWithdraw && (Date.now() - user.lastDailyProfitWithdraw) < (3 * 24 * 60 * 60 * 1000)) {
                dailyProfitBtn.disabled = true;
                const nextWithdraw = new Date(user.lastDailyProfitWithdraw + (3 * 24 * 60 * 60 * 1000));
                const timeLeft = nextWithdraw - Date.now();
                const hoursLeft = Math.floor(timeLeft / (1000 * 60 * 60));
                dailyProfitBtn.innerHTML = `<i class="fas fa-clock"></i> ${hoursLeft} SAAT QALIB`;
                dailyProfitBtn.title = `N√∂vb…ôti √ßƒ±xarƒ±≈ü: ${nextWithdraw.toLocaleDateString('az-AZ')}`;
            } else {
                dailyProfitBtn.disabled = false;
                dailyProfitBtn.innerHTML = `<i class="fas fa-wallet"></i> G√úND∆èLƒ∞K G∆èLƒ∞Rƒ∞ √á∆èK ($${dailyProfit.toFixed(2)})`;
            }
        }

        function withdrawDailyProfit() {
            vibe();
            
            const dailyProfit = calculateDailyProfit();
            
            // Minimum m…ôbl…ôƒü yoxlamasƒ±
            if (dailyProfit < 20) {
                alert("‚ùå Minimum √ßƒ±xarƒ±≈ü m…ôbl…ôƒüi: $20\nG√ºnl√ºk g…ôliriniz: $" + dailyProfit.toFixed(2));
                return;
            }
            
            // 3 g√ºn g√∂zl…ôm…ô yoxlamasƒ±
            if (user.lastDailyProfitWithdraw && (Date.now() - user.lastDailyProfitWithdraw) < (3 * 24 * 60 * 60 * 1000)) {
                const nextWithdraw = new Date(user.lastDailyProfitWithdraw + (3 * 24 * 60 * 60 * 1000));
                alert("‚è≥ G√ºnd…ôlik g…ôliri 3 g√ºnd…ôn bir √ß…ôk…ô bil…ôrsiniz!\n\n" +
                      "üìÖ Son √ßƒ±xarƒ±≈ü: " + new Date(user.lastDailyProfitWithdraw).toLocaleDateString('az-AZ') + "\n" +
                      "‚úÖ N√∂vb…ôti √ßƒ±xarƒ±≈ü: " + nextWithdraw.toLocaleDateString('az-AZ'));
                return;
            }
            
            // T…ôsdiq mesajƒ±
            if (confirm(`üí∞ G√úND∆èLƒ∞K G∆èLƒ∞Rƒ∞ √á∆èKMEK ƒ∞ST∆èYƒ∞RSƒ∞Nƒ∞Z?\n\n` +
                       `üìä M…ôbl…ôƒü: $${dailyProfit.toFixed(2)}\n` +
                       `‚è∞ M√ºdd…ôt: 3 g√ºnd…ôn bir\n\n` +
                       `‚ö†Ô∏è WhatsApp-a y√∂nl…ôndiril…ôn m…ôlumatƒ± D∆èYƒ∞≈ûM∆èK QADAƒûANDIR!\n` +
                       `üì± M…ôlumat formasƒ± avtomatik g√∂nd…ôril…ôc…ôk.`)) {
        
                // WhatsApp mesajƒ± hazƒ±rla
                const message = `G√ºnd…ôlik g…ôlir √ßƒ±xarƒ±≈üƒ±: $${dailyProfit.toFixed(2)} (${user.email})\n` +
                               `Tarix: ${new Date().toLocaleDateString('az-AZ')}\n` +
                               `G√ºnl√ºk g…ôlir faizi: 1.5%\n` +
                               `√úmumi investisiya: $${user.totalInvested.toFixed(2)}\n\n` +
                               `‚ö†Ô∏è BU M∆èLUMATI D∆èYƒ∞≈ûDƒ∞RM∆èYƒ∞N!`;
                
                // WhatsApp-a y√∂nl…ôndir
                window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=${encodeURIComponent(message)}`, '_blank');
                
                // G…ôliri Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô et
                user.availableBalance += dailyProfit;
                
                // √áƒ±xarƒ±≈ü tarixini qeyd et
                user.lastDailyProfitWithdraw = Date.now();
                user.dailyProfitWithdrawCount = (user.dailyProfitWithdrawCount || 0) + 1;
                
                // Tarix√ß…ôy…ô …ôlav…ô et
                addToHistory("G√ºnd…ôlik G…ôlir √áƒ±xarƒ±≈üƒ±", `+$${dailyProfit.toFixed(2)}`);
                
                // UI v…ô m…ôlumatlarƒ± yenil…ô
                updateUI();
                saveData();
                
                sync(`Daily Profit Withdraw: $${dailyProfit.toFixed(2)}`);
                
                // Uƒüur mesajƒ±
                alert(`‚úÖ Uƒüurlu! $${dailyProfit.toFixed(2)} g√ºnd…ôlik g…ôlir √ß…ôkildi.\n\n` +
                      `üí∞ M…ôbl…ôƒü Disponibil Balansa …ôlav…ô edildi.\n` +
                      `üìÖ N√∂vb…ôti √ßƒ±xarƒ±≈ü 3 g√ºn sonra m√ºmk√ºnd√ºr.\n\n` +
                      `‚ö†Ô∏è WhatsApp-da m…ôlumat formasƒ±nƒ± D∆èYƒ∞≈ûM∆èYƒ∞N!`);
            }
        }

        // --- CARD EDIT LOGIC ---
        function toggleCardEdit() {
            let f = document.getElementById('cardEditForm');
            f.style.display = f.style.display === 'block' ? 'none' : 'block';
        }
        
        function saveCardDetails() {
            let name = document.getElementById('newCardName').value.trim();
            let num = document.getElementById('newCardNum').value.trim();
            
            if(name) user.cardName = name.toUpperCase();
            if(num) {
                const cleaned = num.replace(/\D/g, '');
                if(cleaned.length === 16) {
                    user.cardNum = cleaned.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/, '$1 ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ $4');
                } else {
                    user.cardNum = num;
                }
            }
            
            saveData();
            updateUI();
            toggleCardEdit();
            alert("Kart m…ôlumatlarƒ± yadda saxlanƒ±ldƒ±!");
        }

        // --- G∆èLƒ∞R HESABLAMA (YALNIZ INVESTƒ∞Sƒ∞YA SONRASI) ---
        function calculateProfit() {
            if (user.investments.length === 0) {
                user.earned = 0;
                user.lastSync = Date.now();
                return;
            }
            
            const now = Date.now();
            const lastSyncTime = user.lastSync || now;
            const timePassed = now - lastSyncTime;
            const secondsPassed = timePassed / 1000;
            
            user.totalInvested = user.investments.reduce((total, inv) => total + inv.amount, 0);
            
            if (user.totalInvested > 0 && secondsPassed > 0) {
                const profitPerSecond = (user.totalInvested * 0.015) / 86400;
                const earned = profitPerSecond * secondsPassed;
                
                if (earned > 0.000001) {
                    user.earned += earned;
                }
            }
            
            user.lastSync = now;
            saveData();
        }

        // --- YENƒ∞: G∆èLƒ∞Rƒ∞ BALANSA K√ñ√á√úR (Dƒ∞SPONƒ∞Bƒ∞L BALANSA) ---
        function claimProfit() {
            vibe();
            
            if (user.earned <= 0.01) {
                alert("‚ö†Ô∏è Minimum √ß…ôkm…ô m…ôbl…ôƒüi: $0.01\nCari qazanc: $" + user.earned.toFixed(6));
                return;
            }
            
            let profit = user.earned;
            // ‚úÖ G…ôliri Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô et
            user.availableBalance += profit;
            
            addToHistory("G…ôlir K√∂√ß√ºrm…ô", `+$${profit.toFixed(2)}`);
            
            // ‚úÖ G…ôliri SIFIRLA (yenid…ôn ba≈ülasƒ±n)
            user.earned = 0;
            user.lastSync = Date.now(); // Zamanƒ± yenil…ô ki, yeni g…ôlir hesablamasƒ± ba≈ülasƒ±n
            
            saveData();
            updateUI();
            playSound();
            
            sync(`Claimed Profit: $${profit.toFixed(2)}`);
            alert(`‚úÖ Uƒüurlu! $${profit.toFixed(2)} Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô olundu.\n\nüí∞ G…ôlir hesablanmasƒ± yenid…ôn ba≈üladƒ±.`);
        }

        // --- YENƒ∞: √úMUMƒ∞ BALANSI √á∆èK (KART √úZ∆èRƒ∞ND∆èKƒ∞ BUTON) ---
        function withdrawFullBalance() {
            vibe();
            
            // Yalnƒ±z Dƒ∞SPONƒ∞Bƒ∞L BALANSI √ß…ôk…ô bil…ôr!
            if (user.availableBalance <= 0) {
                alert("‚ùå Disponibil balansƒ±nƒ±z yoxdur!\n\n" +
                      "üí∞ √úmumi Balans: $" + (user.availableBalance + user.earned + user.investments.reduce((a,b)=>a+b.amount,0)).toFixed(2) + "\n" +
                      "üí≥ Disponibil Balans: $" + user.availableBalance.toFixed(2) + "\n" +
                      "üìà Aktiv S…ôrmay…ô: $" + user.investments.reduce((a,b)=>a+b.amount,0).toFixed(2) + "\n" +
                      "üéØ G…ôlir: $" + user.earned.toFixed(2));
                return;
            }
            
            const withdrawAmount = user.availableBalance;
            
            if (withdrawAmount < 20) {
                alert("‚ö†Ô∏è Minimum √ßƒ±xarƒ±≈ü m…ôbl…ôƒüi: $20\nCari balans: $" + withdrawAmount.toFixed(2));
                return;
            }
            
            if (user.lastWithdraw && (Date.now() - user.lastWithdraw) < 259200000) {
                alert("‚ö†Ô∏è √áƒ±xarƒ±≈ü 3 g√ºnd…ôn bir m√ºmk√ºnd√ºr.");
                return;
            }

            if (confirm(`üí∞ √úMUMƒ∞ Dƒ∞SPONƒ∞Bƒ∞L BALANSI √á∆èKMEK ƒ∞ST∆èYƒ∞RSƒ∞Nƒ∞Z?\n\n` +
                       `üí≥ M…ôbl…ôƒü: $${withdrawAmount.toFixed(2)}\n\n` +
                       `‚ö†Ô∏è B√ºt√ºn disponibil balans WhatsApp-a y√∂nl…ôndiril…ôc…ôk.\n` +
                       `‚úÖ Balansƒ±nƒ±z sƒ±fƒ±rlanacaq.`)) {
                
                // WhatsApp-a y√∂nl…ôndir
                const message = `Salam, √úMUMƒ∞ Dƒ∞SPONƒ∞Bƒ∞L BALANSI √ß…ôkm…ôk ist…ôyir…ôm: $${withdrawAmount.toFixed(2)} (${user.email})`;
                window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=${encodeURIComponent(message)}`, '_blank');
                
                // ‚úÖ BALANSI SIFIRLA
                user.availableBalance = 0;
                user.lastWithdraw = Date.now();
                
                addToHistory("√úmumi Balans √áƒ±xarƒ±≈üƒ±", `-$${withdrawAmount.toFixed(2)}`);
                
                updateUI(); 
                saveData(); 
                
                sync(`Full Withdraw: $${withdrawAmount.toFixed(2)}`);
                
                alert(`‚úÖ Uƒüurlu! $${withdrawAmount.toFixed(2)} m…ôbl…ôƒüi √º√ß√ºn WhatsApp-a y√∂nl…ôndirildiniz.\n\n` +
                      `üí∞ Disponibil balansƒ±nƒ±z sƒ±fƒ±rlandƒ±.`);
            }
        }

        function addToHistory(type, amount) {
            if(!user.history) user.history = [];
            user.history.unshift({ 
                type: type, 
                amount: amount, 
                time: new Date().toLocaleTimeString('az-AZ', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: '2-digit'
                })
            });
            if(user.history.length > 20) user.history.pop();
        }

        // --- CALCULATOR ---
        function calcProfit() {
            let val = parseFloat(document.getElementById('calcInput').value) || 0;
            const daily = val * 0.015;
            const monthly = daily * 30;
            
            document.getElementById('calcDaily').innerText = "$" + daily.toFixed(2);
            document.getElementById('calcMonthly').innerText = "$" + monthly.toFixed(2);
        }

        // --- REAL-TIME UPDATE ---
        function liveUpdate() {
            calculateProfit();
            updateUI();
            updateDailyProfitUI(); // <-- BU S∆èTRƒ∞ ∆èLAV∆è ET
            
            if (user.totalInvested > 0) {
                const profitPerSecond = (user.totalInvested * 0.015) / 86400;
                document.getElementById('debugPerSec').innerText = "$" + profitPerSecond.toFixed(8);
                document.getElementById('debugTime').innerText = new Date().toLocaleTimeString();
            }
        }

        // --- LOGIN ---
        function startBiometricLogin() {
            const btn = document.querySelector('.auth-card button');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> SCANNING...`;
            
            setTimeout(() => { 
                handleLogin();
                btn.innerHTML = originalText;
            }, 1500);
        }

        async function handleLogin() {
            const n = document.getElementById('rName').value.trim();
            const e = document.getElementById('rEmail').value.trim();
            
            if(!n || !e) {
                alert("Xanalarƒ± doldurun!");
                return;
            }
            
            try {
                const res = await fetch(`${API}?action=login&name=${encodeURIComponent(n)}&email=${encodeURIComponent(e)}`);
                const data = await res.json();
                
                user.name = n; 
                user.email = e; 
                // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANSI y√ºkl…ô
                user.availableBalance = parseFloat(data.data?.balance || 0); 
                user.earned = parseFloat(data.data?.earned || 0);
                
                const saved = localStorage.getItem(STORAGE_KEY);
                if(saved) { 
                    const savedUser = JSON.parse(saved); 
                    if(savedUser.email === e) { 
                        // ∆èsas…ôn Dƒ∞SPONƒ∞Bƒ∞L BALANSI saxla
                        user.availableBalance = Math.max(user.availableBalance, savedUser.availableBalance || savedUser.balance || 0);
                        user.earned = Math.max(user.earned, savedUser.earned || 0);
                        user.investments = savedUser.investments || []; 
                        user.lastWithdraw = savedUser.lastWithdraw || 0;
                        // YENƒ∞: G√ºnd…ôlik g…ôlir √ßƒ±xarƒ±≈ü m…ôlumatlarƒ±nƒ± y√ºkl…ô
                        user.lastDailyProfitWithdraw = savedUser.lastDailyProfitWithdraw || 0;
                        user.dailyProfitWithdrawCount = savedUser.dailyProfitWithdrawCount || 0;
                        user.cardName = savedUser.cardName || user.name;
                        user.cardNum = savedUser.cardNum || "4455 ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 9012";
                        user.history = savedUser.history || [];
                        user.lastSync = savedUser.lastSync || Date.now();
                        user.totalInvested = savedUser.totalInvested || 
                            user.investments.reduce((sum, inv) => sum + inv.amount, 0);
                    }
                }
                
                saveData(); 
                initApp();
                
            } catch(error) { 
                console.error("Login error:", error);
                user.name = n;
                user.email = e;
                user.availableBalance = 1000; // Demo Dƒ∞SPONƒ∞Bƒ∞L balans
                saveData();
                initApp();
            }
        }

        function initApp() {
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'block';
            document.getElementById('dispName').innerText = user.name;
            document.getElementById('cardNameDisplay').innerText = user.cardName || user.name;
            
            calculateProfit();
            renderGrid(); 
            updateUI();
            updateDailyProfitUI(); // <-- BU S∆èTRƒ∞ ∆èLAV∆è ET
            
            setInterval(liveUpdate, 1000);
            
            console.log("App initialized for:", user.email);
        }

        function logout() {
            if(confirm("√áƒ±xƒ±≈ü etm…ôk ist…ôyirsiniz?")) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        // --- YENƒ∞: ƒ∞NVESTƒ∞Sƒ∞YA FUNKSƒ∞YASI (Dƒ∞SPONƒ∞Bƒ∞L BALANSDAN √áIXILIR) ---
        function invest(n, p) {
            vibe();
            
            // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANS yoxla
            if(user.availableBalance < p) { 
                if(confirm("Dƒ∞SPONƒ∞Bƒ∞L balansƒ±nƒ±z √ßatmƒ±r. Balans artƒ±rmaq √º√ß√ºn c√ºzdana ke√ßilsin?")) {
                    switchView('cabinet');
                }
                return; 
            }
            
            // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANSDAN √áIX!
            user.availableBalance -= p; 
            
            user.investments.push({
                name: n, 
                amount: p, 
                time: Date.now(),
                endTime: Date.now() + (30 * 24 * 60 * 60 * 1000),
                canWithdraw: false
            });
            
            user.totalInvested += p;
            user.lastSync = Date.now();
            
            addToHistory("ƒ∞nvestisiya", `-$${p} (${n})`);
            
            document.getElementById('successMsg').innerHTML = `
                ‚úÖ <b>${n}</b> paketin…ô <b>$${p}</b> investisiya etdiniz.<br><br>
                üìå <small>Bu m…ôbl…ôƒü Dƒ∞SPONƒ∞Bƒ∞L BALANSDAN √áIXILDI</small><br>
                ‚è≥ <small>30 g√ºn …ôrzind…ô √á∆èKƒ∞L∆è Bƒ∞LM∆èZ</small><br>
                üí∞ <small>G√ºnl√ºk g…ôlir: <b>$${(p * 0.015).toFixed(2)}</b></small>
            `;
            
            openModal('successModal');
            playSound(); 
            updateUI(); 
            saveData(); 
            
            showSocialToast(`${user.name.split(' ')[0]} $${p} invest etdi!`);
            
            sync(`Invest: ${n} $${p}`);
            
            setTimeout(() => {
                showInvestmentLockMessage();
            }, 500);
        }

        // --- YENƒ∞: SERMAY∆èNƒ∞ GERƒ∞ √á∆èK FUNKSƒ∞YASI ---
        function withdrawPrincipal(index) {
            vibe();
            
            if (index < 0 || index >= user.investments.length) return;
            
            let inv = user.investments[index];
            const now = Date.now();
            const daysPassed = Math.floor((now - inv.time) / (86400000));
            const daysLeft = 30 - daysPassed;
            
            if(daysPassed < 30) {
                alert(`‚è≥ Bu s…ôrmay…ô h…ôl…ô kilidlidir!\n\nüìÖ ${30 - daysPassed} g√ºn qalƒ±b.\n\n‚úÖ 30 g√ºn tamamlandƒ±qdan sonra "S…ôrmay…ôni Geri √á…ôk" d√ºym…ôsi aktiv olacaq.`);
                return;
            }

            if(confirm(`üí∞ Ana pulu ($${inv.amount}) √ß…ôkm…ôk ist…ôyirsiniz?\n\n‚ö†Ô∏è Qeyd: Bu investisiyadan g…ôlir DAYANACAQ.\n\n‚úÖ M…ôbl…ôƒü Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô olunacaq.`)) {
                // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô et
                user.availableBalance += inv.amount;
                
                user.investments.splice(index, 1);
                user.totalInvested -= inv.amount;
                
                addToHistory("S…ôrmay…ô Geri √á…ôk", `+$${inv.amount}`);
                saveData(); 
                updateUI();
                
                sync(`Withdrew Principal: $${inv.amount}`);
                
                alert(`‚úÖ Uƒüurlu! $${inv.amount} Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô edildi.\n\nüí∞ Bu m…ôbl…ôƒüi indi istifad…ô ed…ô v…ô ya yeni investisiya ed…ô bil…ôrsiniz.`);
                
                setTimeout(() => {
                    if(confirm("üì± √áƒ±xarƒ±≈üƒ± r…ôsmil…ô≈üdirm…ôk √º√ß√ºn WhatsApp-a ke√ßilsin?")) {
                        window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=Salam, ana sermayemi geri cekmek istiyorum: $${inv.amount} (${user.email})`, '_blank');
                    }
                }, 1000);
            }
        }

        // --- YENƒ∞L∆èNMƒ∞≈û UI UPDATE ---
        function updateUI() {
            // Balans tipl…ôrini g√∂st…ôr
            updateBalanceDisplay();
            
            // G…ôlir g√∂st…ôricisi
            document.getElementById('dispEarned').innerText = "$" + user.earned.toFixed(6);
            document.getElementById('cardNameDisplay').innerText = user.cardName || user.name;
            document.getElementById('cardNumDisplay').innerText = user.cardNum;
            
            // Debug info
            const totalInv = user.investments.reduce((a,b) => a + b.amount, 0);
            document.getElementById('debugInv').innerText = "$" + totalInv.toFixed(2);
            
            // Portfolio count
            document.getElementById('portfolioCount').innerText = user.investments.length + " investisiya";
            
            // Profit status
            const profitStatus = document.getElementById('profitStatus');
            if (user.totalInvested > 0) {
                profitStatus.innerHTML = '‚óè <span style="color:lime">Aktivdir</span>';
                profitStatus.className = "blink";
            } else {
                profitStatus.innerHTML = '‚óè <span style="color:#ccc">G√∂zl…ôyir</span>';
                profitStatus.className = "";
            }
            
            // Portfolio List
            let portfolioHtml = "";
            user.investments.forEach((i, index) => {
                const now = Date.now();
                const startTime = i.time;
                const daysPassed = Math.floor((now - startTime) / (86400000));
                const daysLeft = Math.max(0, 30 - daysPassed);
                const isLocked = daysPassed < 30;
                
                const investmentDaily = i.amount * 0.015;
                const investmentEarned = investmentDaily * (daysPassed / 30);
                
                let statusHtml, btnHtml, borderColor, statusColor;
                
                if (isLocked) {
                    statusHtml = `<span style="color:#ff9800; font-size:10px;">üîí ${daysLeft} g√ºn qalƒ±b</span>`;
                    btnHtml = `<button class="btn-withdraw-locked" style="border:none; border-radius:4px; padding:5px 8px; font-size:10px; cursor:not-allowed;" disabled>Kƒ∞Lƒ∞DLƒ∞</button>`;
                    borderColor = '#ff9800';
                    statusColor = '#ff9800';
                } else {
                    statusHtml = `<span style="color:#28a745; font-size:10px;">‚úÖ M√ºdd…ôt bitdi</span>`;
                    btnHtml = `<button class="btn-withdraw-active" onclick="withdrawPrincipal(${index})" style="border:none; border-radius:4px; padding:5px 10px; font-size:10px; cursor:pointer;">S∆èRMAY∆èNƒ∞ GERƒ∞ √á∆èK</button>`;
                    borderColor = '#28a745';
                    statusColor = '#28a745';
                }
                
                portfolioHtml += `
                <div style="background:#f8f9fa; padding:10px; margin-bottom:8px; border-radius:8px; font-size:12px; border-left:3px solid ${borderColor};">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">
                        <div><b>${i.name}</b></div>
                        <div>${statusHtml}</div>
                    </div>
                    <div style="color:#666; font-size:11px;">
                        üí∞ Investisiya: <b>$${i.amount}</b><br>
                        üìà G…ôlir/g√ºn: <span style="color:green">$${investmentDaily.toFixed(2)}</span><br>
                        üìÖ M√ºdd…ôt: ${daysPassed}/30 g√ºn<br>
                        üè¶ √úmumi g…ôlir: <b style="color:${statusColor}">$${investmentEarned.toFixed(2)}</b>
                    </div>
                    <div style="margin-top:8px; text-align:right;">
                        ${btnHtml}
                    </div>
                </div>`;
            });
            
            document.getElementById('portfolioList').innerHTML = portfolioHtml || 
                `<div style="text-align:center; color:#999; font-size:12px; padding:20px; background:#f9f9f9; border-radius:8px;">
                    üì≠ H…ôl…ô investisiya yoxdur<br>
                    <small style="font-size:10px;">G…ôlir YALNIZ investisiya sonrasƒ± hesablanƒ±r</small>
                </div>`;

            // History List
            let historyHtml = "";
            if(user.history && user.history.length > 0) {
                user.history.forEach(h => { 
                    const isPositive = h.amount.includes('+');
                    historyHtml += `
                    <div class="history-item">
                        <span class="history-type">${h.type}</span>
                        <div style="text-align:right;">
                            <span style="color:${isPositive ? 'green' : 'red'}; font-weight:bold;">${h.amount}</span><br>
                            <span class="history-time">${h.time}</span>
                        </div>
                    </div>`; 
                });
            } else { 
                historyHtml = `<div style="text-align:center; color:#999; font-size:12px; padding:20px;">Tarix√ß…ô bo≈üdur</div>`; 
            }
            document.getElementById('historyList').innerHTML = historyHtml;
            
            showInvestmentLockMessage();
            
            // YENƒ∞: G√ºnd…ôlik g…ôlir UI-ni yenil…ô
            updateDailyProfitUI();
        }

        function toggleTheme() { 
            if(document.body.getAttribute('data-theme') === 'dark') {
                document.body.removeAttribute('data-theme');
                event.target.innerText = "DARK";
            } else {
                document.body.setAttribute('data-theme', 'dark');
                event.target.innerText = "LIGHT";
            }
            showInvestmentLockMessage();
        }
        
        function requestDeposit() { 
            let amount = prompt("üí∞ Balans artƒ±rma m…ôbl…ôƒüi ($):", "100"); 
            if(amount && !isNaN(parseFloat(amount))) {
                window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=Salam, Dƒ∞SPONƒ∞Bƒ∞L balans artirmaq isteyirem: $${amount} (${user.email})`, '_blank'); 
            }
        }
        
        function handleWithdraw() { 
            // ‚úÖ YALNIZ Dƒ∞SPONƒ∞Bƒ∞L BALANSDAN √á∆èK∆è Bƒ∞L∆èR!
            if (user.availableBalance <= 0) {
                alert("‚ùå Disponibil balansƒ±nƒ±z yoxdur!\n\n" +
                      "üí∞ √úmumi Balans: $" + (user.availableBalance + user.earned + user.investments.reduce((a,b)=>a+b.amount,0)).toFixed(2) + "\n" +
                      "üí≥ Disponibil Balans: $" + user.availableBalance.toFixed(2));
                return;
            }
            
            let amount = prompt("üí≥ √áƒ±xarƒ±≈ü m…ôbl…ôƒüi ($):", Math.min(50, user.availableBalance).toFixed(0)); 
            if(amount) {
                let withdrawAmount = parseFloat(amount);
                if(isNaN(withdrawAmount) || withdrawAmount <= 0) {
                    alert("‚ö†Ô∏è D√ºzg√ºn m…ôbl…ôƒü daxil edin!");
                    return;
                }
                
                if(withdrawAmount > user.availableBalance) {
                    alert("‚ùå Disponibil balansda kifay…ôt q…ôd…ôr v…ôsait yoxdur.\n\n" +
                         "üí≥ Disponibil Balans: $" + user.availableBalance.toFixed(2));
                    return;
                }
                
                if(withdrawAmount < 20) {
                    alert("‚ö†Ô∏è Minimum √ßƒ±xarƒ±≈ü m…ôbl…ôƒüi: $20");
                    return;
                }
                
                if(user.lastWithdraw && (Date.now() - user.lastWithdraw) < 259200000) {
                    alert("‚ö†Ô∏è √áƒ±xarƒ±≈ü 3 g√ºnd…ôn bir m√ºmk√ºnd√ºr.");
                    return;
                }

                user.availableBalance -= withdrawAmount;
                user.lastWithdraw = Date.now();
                addToHistory("Pul √áƒ±xarƒ±≈üƒ±", `-$${withdrawAmount}`);
                
                updateUI(); 
                saveData(); 
                
                sync(`Withdraw: $${withdrawAmount}`);
                
                window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=Salam, pul cekmek isteyirem: $${withdrawAmount} (${user.email})`, '_blank');
            } 
        }
        
        async function applyPromo() { 
            let code = document.getElementById('pCode').value.trim(); 
            if(!code) {
                alert("‚ö†Ô∏è Promo kodu daxil edin!");
                return;
            }
            
            try { 
                let res = await fetch(`${API}?action=applyCode&code=${code}&email=${user.email}`);
                let data = await res.json(); 
                
                if(data.result === 'success') { 
                    // ‚úÖ Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô et
                    user.availableBalance += data.amount; 
                    addToHistory("Promo Kod", `+$${data.amount}`);
                    
                    updateUI(); 
                    saveData(); 
                    
                    sync(`Promo applied: $${data.amount}`);
                    
                    alert(`‚úÖ Uƒüurlu! $${data.amount} Dƒ∞SPONƒ∞Bƒ∞L BALANSA …ôlav…ô edildi.\n\nüí∞ ƒ∞ndi investisiya ed…ô bil…ôrsiniz!`);
                    playSound(); 
                    
                    document.getElementById('pCode').value = '';
                    
                } else {
                    alert("‚ùå Yanlƒ±≈ü v…ô ya istifad…ô edilmi≈ü promo kod!");
                }
            } catch(e) {
                console.error("Promo error:", e);
                alert("‚ö†Ô∏è ≈û…ôb…ôk…ô x…ôtasƒ±. Offline rejimd…ô i≈ül…ôyirsiniz.\nDemo: +$50 …ôlav…ô edildi.");
                
                user.availableBalance += 50;
                addToHistory("Promo Kod (Demo)", "+$50");
                updateUI();
                saveData();
                document.getElementById('pCode').value = '';
            }
        }
        
        function saveData() { 
            localStorage.setItem(STORAGE_KEY, JSON.stringify(user)); 
        }
        
        function sync(status) { 
            if(user.email) {
                fetch(`${API}?action=sync&email=${user.email}&balance=${user.availableBalance}&invested=${user.totalInvested}&status=${status}`, {
                    mode: 'no-cors'
                }).catch(e => console.log("Sync failed (offline)"));
            }
        }
        
        function switchView(v, btn) { 
            document.querySelectorAll('[id^="view-"]').forEach(el => {
                el.style.display = 'none';
            });
            
            document.getElementById(`view-${v}`).style.display = 'block';
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
        }
        
        function contactSupport() { 
            window.open(`https://api.whatsapp.com/send?phone=${PHONE}&text=Salam, TrendDS d…ôst…ôk lazƒ±mdƒ±r. (${user.email})`, '_blank'); 
        }
        
        function renderGrid() {
            const grid = document.getElementById('marketGrid'); 
            grid.innerHTML = "";
            
            markets.forEach(m => {
                let hotHtml = m.hot ? `<span class="hot-tag">HOT</span>` : '';
                let dailyProfit = m.p * 0.015;
                
                grid.innerHTML += `
                <div class="item-card">
                    ${hotHtml}
                    <img src="${m.img}?auto=format&fit=crop&q=80" class="item-img" loading="lazy">
                    <div class="item-body">
                        <div style="font-weight:700; font-size:14px;">${m.n}</div>
                        <div style="color:var(--primary); font-weight:bold; font-size:18px;">$${m.p}</div>
                        <div style="font-size:11px; color:#666; margin:5px 0;">
                            üìà G√ºnl√ºk: <b>$${dailyProfit.toFixed(2)}</b>
                        </div>
                        <button class="btn-main" style="margin-top:5px; padding:8px; font-size:12px;" 
                                onclick="invest('${m.n}', ${m.p})"
                                ontouchstart="this.style.opacity='0.8'" 
                                ontouchend="this.style.opacity='1'">
                            <i class="fas fa-chart-line"></i> INVEST
                        </button>
                    </div>
                </div>`;
            });
        }
        
        function showSocialToast(message) {
            const toast = document.getElementById('socialToast');
            const text = document.getElementById('stText');
            
            text.innerText = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // G…ôlir Analizi
        function showProfitAnalysis() {
            const totalInv = user.investments.reduce((a,b) => a + b.amount, 0);
            
            if (totalInv === 0) {
                alert("‚ùå H…ôl…ô investisiya yoxdur!\n\nG…ôlir YALNIZ investisiya etdikd…ôn sonra hesablanƒ±r.");
                return;
            }
            
            const dailyProfit = totalInv * 0.015;
            const monthlyProfit = dailyProfit * 30;
            const profitPerSecond = dailyProfit / 86400;
            
            alert(`üí∞ G∆èLƒ∞R T∆èHLƒ∞Lƒ∞:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
√úmumi Investisiya: $${totalInv.toFixed(2)}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
G√úNL√úK G∆èLƒ∞R: $${dailyProfit.toFixed(2)} (1.5%)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
AYLIQ G∆èLƒ∞R: $${monthlyProfit.toFixed(2)}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Saniy…ôlik: $${profitPerSecond.toFixed(8)}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Cari qazanc: $${user.earned.toFixed(6)}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Aktiv investisiya: ${user.investments.length}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ`);
        }
    </script>
</body>
</html>
